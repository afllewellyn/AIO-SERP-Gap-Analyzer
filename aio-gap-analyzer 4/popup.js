import{r as s,j as a,c as w}from"./index.js";const x=()=>{const[n,l]=s.useState("no-aio"),[c,d]=s.useState(""),[r,i]=s.useState(""),[u,m]=s.useState(!1),[t,p]=s.useState(null);s.useEffect(()=>{chrome.storage.local.get(["aioData"],e=>{e.aioData&&(p(e.aioData),l("aio-detected"),d(e.aioData.query))}),chrome.tabs.query({active:!0,currentWindow:!0},e=>{const o=e[0]?.url;o&&!o.includes("google.com")&&i(o)})},[]);const y=async()=>{if(!(!r.trim()||!t)){m(!0);try{const e=await fetch("https://aio-serp-gap-analyzer.vercel.app/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:t.query,aiOverviewText:t.aiOverviewText,citedSources:t.citedSources,blogUrl:r.trim()})});if(!e.ok)throw new Error("Analysis failed");const o=await e.json();await chrome.storage.local.set({analysisResult:{...o,timestamp:new Date().toISOString(),query:t.query}}),chrome.sidePanel.open({windowId:chrome.windows.WINDOW_ID_CURRENT})}catch(e){console.error("Analysis error:",e),alert("Analysis failed. Please try again.")}finally{m(!1)}}},g=()=>{chrome.sidePanel.open({windowId:chrome.windows.WINDOW_ID_CURRENT})},v=()=>{chrome.storage.local.remove(["aioData","analysisResult"]),p(null),l("no-aio"),d(""),i("")};return a.jsxs("div",{className:"popup",children:[a.jsxs("div",{className:"status",children:[a.jsx("div",{className:`status-indicator ${n}`,children:n==="aio-detected"?"âœ“ AI Overview detected":"No AI Overview detected"}),c&&a.jsxs("div",{className:"query",children:["Query: ",c]})]}),a.jsxs("div",{className:"form",children:[a.jsx("label",{htmlFor:"blogUrl",children:"Blog/Article URL:"}),a.jsx("input",{id:"blogUrl",type:"url",value:r,onChange:e=>i(e.target.value),placeholder:"https://example.com/blog-post",disabled:!t}),a.jsxs("div",{className:"buttons",children:[a.jsx("button",{onClick:y,disabled:!t||!r.trim()||u,className:"primary",children:u?"Running...":"Run Gap Analysis"}),a.jsx("button",{onClick:g,className:"secondary",children:"Open Side Panel"})]}),a.jsx("button",{onClick:v,className:"clear",children:"Clear Stored Data"})]})]})},h=document.getElementById("popup-root");h&&w.createRoot(h).render(a.jsx(x,{}));
