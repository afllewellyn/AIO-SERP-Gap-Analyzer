import{r as s,j as t,c as x}from"./index.js";const f=()=>{const[i,l]=s.useState("no-aio"),[c,d]=s.useState(""),[o,n]=s.useState(""),[u,m]=s.useState(!1),[a,p]=s.useState(null);s.useEffect(()=>{chrome.storage.local.get(["aioData"],e=>{e.aioData&&(p(e.aioData),l("aio-detected"),d(e.aioData.query))}),chrome.tabs.query({active:!0,currentWindow:!0},e=>{const r=e[0]?.url;r&&!r.includes("google.com")&&n(r)})},[]);const g=async()=>{if(!(!o.trim()||!a)){m(!0);try{const e=await fetch("https://aio-serp-gap-analyzer.vercel.app/api/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:a.query,aiOverviewText:a.aiOverviewText,citedSources:a.citedSources,blogUrl:o.trim()})});if(!e.ok)throw new Error("Analysis failed");const r=await e.json();await chrome.storage.local.set({analysisResult:{...r,timestamp:new Date().toISOString(),query:a.query}});const[y]=await chrome.tabs.query({active:!0,currentWindow:!0});y?.id!=null&&chrome.sidePanel.open({tabId:y.id})}catch(e){console.error("Analysis error:",e),alert("Analysis failed. Please try again.")}finally{m(!1)}}},v=async()=>{const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});e?.id!=null&&chrome.sidePanel.open({tabId:e.id})},b=()=>{chrome.storage.local.remove(["aioData","analysisResult"]),p(null),l("no-aio"),d(""),n("")};return t.jsxs("div",{className:"popup",children:[t.jsxs("div",{className:"status",children:[t.jsx("div",{className:`status-indicator ${i}`,children:i==="aio-detected"?"âœ“ AI Overview detected":"No AI Overview detected"}),c&&t.jsxs("div",{className:"query",children:["Query: ",c]})]}),t.jsxs("div",{className:"form",children:[t.jsx("label",{htmlFor:"blogUrl",children:"Blog/Article URL:"}),t.jsx("input",{id:"blogUrl",type:"url",value:o,onChange:e=>n(e.target.value),placeholder:"https://example.com/blog-post",disabled:!a}),t.jsxs("div",{className:"buttons",children:[t.jsx("button",{onClick:g,disabled:!a||!o.trim()||u,className:"primary",children:u?"Running...":"Run Gap Analysis"}),t.jsx("button",{onClick:v,className:"secondary",children:"Open Side Panel"})]}),t.jsx("button",{onClick:b,className:"clear",children:"Clear Stored Data"})]})]})},h=document.getElementById("popup-root");h&&x.createRoot(h).render(t.jsx(f,{}));
